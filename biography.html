<!DOCTYPE html>
<html lang="us">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>


	<title>Videnacry - Biography</title>


	<!-- JQUERY-UI CSS file-->
	<link href="jquery-ui.css" rel="stylesheet">

	<!-- Slick CSS files-->
	<link href="plugins\slick-1.8.1\slick\slick.css" rel="stylesheet">
	<link href="plugins\slick-1.8.1\slick\slick-theme.css" rel="stylesheet">
	
	<!-- Magnific Popup core CSS file -->
	<link rel="stylesheet" href="plugins/Magnific-Popup-master/dist/magnific-popup.css">
	
	<!-- Fine uploader CSS file -->
	<link rel="stylesheet" href="./plugins/fine-uploader/fine-uploader-gallery.min.css"/>


	<!-- Own CSS files -->
	<link href="./biography.css" rel="stylesheet">
	<link href="./components/carrouselY.css" rel="stylesheet">
	<link href="./components/navbar.css" rel="stylesheet">
	

	<!-- JQUERY & JQUERY-UI JS files-->
	<script src="external/jquery/jquery.js"></script>
	<script src="jquery-ui.js"></script>
	

	<!-- Magnific Popup core JS file -->
	<script src="plugins/Magnific-Popup-master/dist/jquery.magnific-popup.js"></script>
	<script src="plugins\slick-1.8.1\slick\slick.min.js"></script>
	
	
	<!-- Fine Uploader JS file-->
	<script src="./plugins/fine-uploader/fine-uploader.min.js"></script>

    
    <!-- Own global JS files -->
    <script src="./config.js"></script>
    <script>
        const urls = getUrls()
    </script>



</head>
<body class="biography-p ui-widget">

<!--------------------------------------------------------BACKGROUND------------------------------------------------------------>

<div class="carrousel-vertical"></div>

<script src="components/carrouselY.js"></script>
<script>
	$('.carrousel-vertical').html(CarrouselY.html)
	CarrouselY.init()
</script>



<!-------------------------------------------------------NAVBAR----------------------------------------------------------------->

<div class="navbar-toggler-space"></div>

<script src="./components/navbar.js"></script>
<script>

$('body').append(Navbar.html)
Navbar.init({fixed: true, variant: 'text-danger', backdropImg: './public/img/magicVertical/Awareness.jpg'})

</script>



<!-----------------------------------------------------BIOGRAPHY----------------------------------------------------------------->

<div class="card">
    <div class="backdrop-blur-y"></div>
    <div class="backdrop-blur-x"></div>
    <article class="biography-s ui-widget-content ui-corner-all">
        <header>
            <h1>Berón Gamboa</h1>
            <hr/>
            <h2>Biography</h2>
        </header>
        <section>
            <div class="img-space"></div>
            <article>
                <div class="header-space">
                    <h1>Berón</h1>
                    <hr/>
                </div>
                <header>Doodle artist</header>
                <p>I love drawing new shapes. Since I can remember I wanted to see on paper what I should draw.</p>
                <p>I love science fiction so magic, occultism, ghosts, demons, angels, mental power... now these themes are my strongest inspiration.</p>
                <p>I want to make meaningful drawings in the near future, share ideas in such an amazing drawing, as to make it easy to remember.</p>
            </article>
        </section>
        <img class="ui-corner-all" src="./public/img/biography/me.png" alt="berón gamboa (videnacry)"/>
    </article>
    <div class="backdrop-blur-x"></div>
    <div class="backdrop-blur-y"></div>
</div>
<br/>





<!--------------------------------------------------------CONTACT----------------------------------------------------------------->


<div class="card">
    <div class="backdrop-blur-y"></div>
    <div class="backdrop-blur-x"></div>
    <form class="biography-s ui-widget-content ui-corner-all">
        <h2>Request a  picture!!!</h2>
        <hr/>
        <h3>Contact information</h3>
        <div class="form-group-row">
            <fieldset class="input-text-group">
                <label for="contact-name"><small>Name</small></label>
                <input name="name" id="contact-name" type="text" class="ui-corner-all">
            </fieldset>
            <fieldset class="input-text-group">
                <label for="contact-email"><small>Email</small></label>
                <input name="email" id="contact-email" type="text" class="ui-corner-all">
            </fieldset>
        </div>
        <fieldset class="input-text-group">
            <label for="contact-message"><small>Message</small></label>
            <textarea name="message" id="contact-message" class="ui-corner-all"></textarea>
        </fieldset>
        <h3>Expected delivery date range</h3>
        <label class="alert-highlight">
            <p class="ui-state-highlight ui-corner-all">The default max date is 40 days from now, unless you select a max date 20 or more days from now. Same goes for min date, it would be 10 days from now or above. In case the delivery can not be for that date you'll be notified!</p>
        </label>
        <div class="date-range">
            <div class="datepicker">
                From
            </div>
            <div class="datepicker">
                To
            </div>
        </div>
        <h3>Reference images</h3>
        <label class="alert-default">
            <p class="ui-state-highlight ui-corner-all">Just would be uploaded 5 images and if image size is more than 2MB(megabytes) would be bad upload, meaning it would updload uncomplete.</p>
        </label>
        <div class="file-gallery"></div>
        <br/>
        <label class="alert-default">
            <p class="ui-state-error ui-corner-all ui-helper-hidden"></p>
        </label>
        <label class="alert-default">
            <p class="ui-corner-all ui-widget-header ui-helper-hidden"></p>
        </label>
        <br/>
        <input class="ui-button ui-state-disabled" type="submit" value="Send" disabled>
    </form>
    <div class="backdrop-blur-x"></div>
    <div class="backdrop-blur-y"></div>
</div>
<!--
    Read the "Getting Started Guide" at http://docs.fineuploader.com/quickstart/01-getting-started.html
    if you are not yet familiar with Fine Uploader UI.
    Please see http://docs.fineuploader.com/features/styling.html for information
    on how to customize this template.
-->
<script type="text/template" id="qq-template">
    <div class="qq-uploader-selector qq-uploader qq-gallery" qq-drop-area-text="Drop files here">
        <div class="qq-total-progress-bar-container-selector qq-total-progress-bar-container">
            <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="qq-total-progress-bar-selector qq-progress-bar qq-total-progress-bar"></div>
        </div>
        <div class="qq-upload-drop-area-selector qq-upload-drop-area" qq-hide-dropzone>
            <span class="qq-upload-drop-area-text-selector"></span>
        </div>
        <div class="qq-upload-button-selector qq-upload-button">
            <div>Upload a file</div>
        </div>
        <span class="qq-drop-processing-selector qq-drop-processing">
            <span>Processing dropped files...</span>
            <span class="qq-drop-processing-spinner-selector qq-drop-processing-spinner"></span>
        </span>
        <ul class="qq-upload-list-selector qq-upload-list" role="region" aria-live="polite" aria-relevant="additions removals">
            <li>
                <span role="status" class="qq-upload-status-text-selector qq-upload-status-text"></span>
                <div class="qq-progress-bar-container-selector qq-progress-bar-container">
                    <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="qq-progress-bar-selector qq-progress-bar"></div>
                </div>
                <span class="qq-upload-spinner-selector qq-upload-spinner"></span>
                <div class="qq-thumbnail-wrapper">
                    <img class="qq-thumbnail-selector" qq-max-size="120" qq-server-scale>
                </div>
                <button type="button" class="qq-upload-cancel-selector qq-upload-cancel">X</button>
                <button type="button" class="qq-upload-retry-selector qq-upload-retry">
                    <span class="qq-btn qq-retry-icon" aria-label="Retry"></span>
                    Retry
                </button>
                
            </li>
        </ul>

        <dialog class="qq-alert-dialog-selector">
            <div class="qq-dialog-message-selector"></div>
            <div class="qq-dialog-buttons">
                <button type="button" class="qq-cancel-button-selector">Close</button>
            </div>
        </dialog>

        <dialog class="qq-confirm-dialog-selector">
            <div class="qq-dialog-message-selector"></div>
            <div class="qq-dialog-buttons">
                <button type="button" class="qq-cancel-button-selector">No</button>
                <button type="button" class="qq-ok-button-selector">Yes</button>
            </div>
        </dialog>

        <dialog class="qq-prompt-dialog-selector">
            <div class="qq-dialog-message-selector"></div>
            <input type="text">
            <div class="qq-dialog-buttons">
                <button type="button" class="qq-cancel-button-selector">Cancel</button>
                <button type="button" class="qq-ok-button-selector">Ok</button>
            </div>
        </dialog>
    </div>
</script>

<script>
    const defaultMinDate = new Date()
    defaultMinDate.setDate(defaultMinDate.getDate() + 10)
    $('.biography-p form .datepicker').datepicker().first().datepicker('setDate', defaultMinDate)
    const defaultMaxDate = new Date()
    defaultMaxDate.setDate(defaultMaxDate.getDate() + 40)
    $('.biography-p form .datepicker').eq(1).datepicker('setDate', defaultMaxDate)




    //-------------------------------------------------GET STATUS OF APPOINTMENTS-----------------------------------------------------------
    const checkStatus = () => {

        $('input:submit').prop('disabled', true).addClass('ui-state-disabled')
        $('.alert-default .ui-state-error').addClass('ui-helper-hidden')
        fetch(urls.appointment.getStatus, {method: 'GET'})
        .then(res => res.json())
        .then(({isFull, message}) => {
            if (!isFull) return $('input:submit').prop('disabled', false).removeClass('ui-state-disabled')
            $('.alert-default .ui-state-error').removeClass('ui-helper-hidden').text(message)
        })
        .catch(({message, details}) => $('.alert-default .ui-state-error').removeClass('ui-helper-hidden').text(message))
    }
    checkStatus()




    //---------------------------------------------------FETCH NEW APPOINTMENT--------------------------------------------------------------
    const canceledFileIds = []
	const uploader = new qq.FineUploader({
		element: $('.biography-p form .file-gallery').get(0),
        callbacks: {
            onCancel: function(id) {
                canceledFileIds.push(id)
            }
        },
		request: {
            autoUpload: false,
            inputName: 'images'
		},
        form: {
            element: $('form').get(0),
            interceptSubmit: false
        }
	})
    $('form').submit(e => {
        e.preventDefault()
        $('.alert-default .ui-state-error').addClass('ui-helper-hidden')
        $('.alert-default .ui-widget-header').addClass('ui-helper-hidden')
        const files = uploader.getUploads().filter((elmt, idx) => !canceledFileIds.includes(idx))
        const formData = new FormData(document.forms[0])
        formData.delete('images')
        files.forEach(file => formData.append('images', file.file))
        formData.append('deliverDateMin', $('.biography-p form .datepicker').first().datepicker('getDate'))
        formData.append('deliverDateMax', $('.biography-p form .datepicker').eq(1).datepicker('getDate'))
        fetch(urls.appointment.put, {method: 'PUT', body: formData})
        .then(res => res.json())
        .then(({message, details}) => {
            checkStatus()
            if (details) return $('.alert-default .ui-state-error').removeClass('ui-helper-hidden').text(details)
            $('.alert-default .ui-widget-header').removeClass('ui-helper-hidden').text(message)
        })
        .catch(({message}) => $('.alert-default .ui-state-error').removeClass('ui-helper-hidden').text(message))
    })
</script>


    
</body>
</html>
